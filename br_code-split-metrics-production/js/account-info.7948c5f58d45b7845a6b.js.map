{"version":3,"sources":["webpack:///./App/Containers/AccountSwitcher/account-switcher.jsx","webpack:///./App/Components/Layout/Header/account-info.jsx"],"names":["AccountSwitcher","setWrapperRef","node","_this","wrapper_ref","handleClickOutside","event","accounts_toggle_btn","target","classList","contains","props","is_visible","toggle","handleLogout","is_positions_drawer_on","togglePositionsDrawer","clearContract","requestLogout","then","cleanUp","React","Component","document","addEventListener","this","removeEventListener","loginid","account_loginid","switchAccount","has_error","clearError","_this2","is_logged_in","real_accounts","account_list","filter","acc","is_virtual","vrt_account","find","main_account_title","length","localize","UpgradeButton","_ref","text","react_default","a","createElement","className","href","urlFor","undefined","rel","ref","map","account","key","classNames","acc-switcher__account--selected","onClick","doSwitch","bind","icon","concat","type","is_upgrade_enabled","upgrade_info","can_open_multi","isEmptyObject","virtual_loginid","propTypes","PropTypes","array","string","func","bool","onClickUpgrade","object","account_switcher","connect","_ref2","client","ui","modules","virtual_account_loginid","trade","contract_trade","AccountInfo","balance","currency","is_dialog_on","toggleDialog","acc-info--show","acc-info--is-virtual","title","toLowerCase","react_transition_group","in","timeout","enter","enterDone","exit","unmountOnExit","account_type"],"mappings":"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","file":"js/account-info.7948c5f58d45b7845a6b.js","sourcesContent":["import classNames        from 'classnames';\nimport PropTypes         from 'prop-types';\nimport React             from 'react';\nimport { localize }      from 'App/i18n';\nimport { urlFor }        from '_common/url';\nimport { isEmptyObject } from '_common/utility';\nimport Icon              from 'Assets/icon.jsx';\nimport { requestLogout } from 'Services/index';\nimport { connect }       from 'Stores/connect';\n\nclass AccountSwitcher extends React.Component {\n    setWrapperRef = (node) => {\n        this.wrapper_ref = node;\n    };\n\n    handleClickOutside = (event) => {\n        const accounts_toggle_btn = !(event.target.classList.contains('acc-info'));\n        if (this.wrapper_ref && !this.wrapper_ref.contains(event.target)\n            && this.props.is_visible && accounts_toggle_btn) {\n            this.props.toggle();\n        }\n    };\n\n    handleLogout = () => {\n        this.props.toggle();\n        if (this.props.is_positions_drawer_on) {\n            this.props.togglePositionsDrawer(); // TODO: hide drawer inside logout, once it is a mobx action\n        }\n        this.props.clearContract();\n        requestLogout().then(this.props.cleanUp);\n    };\n\n    componentDidMount() {\n        document.addEventListener('mousedown', this.handleClickOutside);\n    }\n\n    componentWillUnmount() {\n        document.removeEventListener('mousedown', this.handleClickOutside);\n    }\n\n    async doSwitch(loginid) {\n        this.props.toggle();\n        if (this.props.account_loginid === loginid) return;\n        await this.props.switchAccount(loginid);\n\n        if (this.props.has_error) {\n            this.props.clearError();\n        }\n    }\n\n    render() {\n        if (!this.props.is_logged_in) return false;\n        // TODO: Once we allow other real accounts (apart from CR), assign correct title and group accounts into list with correct account title/types\n        // e.g - Real, Financial, Gaming, Investment\n        const real_accounts = this.props.account_list.filter(acc => !acc.is_virtual);\n        const vrt_account   = this.props.account_list.find(acc => acc.is_virtual);\n\n        const main_account_title = real_accounts.length > 1 ? localize('Real accounts') : localize('Real account');\n\n        const UpgradeButton = ({ text }) => (\n            <div className='acc-switcher__new-account'>\n                <a\n                    className='acc-switcher__new-account-link'\n                    href={urlFor('user/accounts', undefined, undefined, true)}\n                    rel='noopener noreferrer'\n                    target='_blank'\n                >\n                    {text}\n                </a>\n            </div>\n        );\n\n        return (\n            <div className='acc-switcher__list' ref={this.setWrapperRef}>\n                {\n                    // Make sure this block is not rendered if there are no real accounts\n                    !!(this.props.account_list.length && real_accounts.length) &&\n                    <div className='acc-switcher__list-group'>\n                        <span className='acc-switcher__list-title'>\n                            {main_account_title}\n                        </span>\n                        <div className='acc-switcher__accounts'>\n                            {\n                                real_accounts.map((account) => (\n                                    <div\n                                        key={account.loginid}\n                                        className={classNames('acc-switcher__account', {\n                                            'acc-switcher__account--selected': (account.loginid === this.props.account_loginid),\n                                        })}\n                                        onClick={this.doSwitch.bind(this, account.loginid)}\n                                    >\n                                        <span className={'acc-switcher__id'}>\n                                            <Icon\n                                                icon='IconAccountsCurrency'\n                                                className={`acc-switcher__id-icon acc-switcher__id-icon--${account.icon}`}\n                                                type={account.icon}\n                                            />\n                                            {account.loginid}\n                                        </span>\n                                    </div>\n                                ))\n                            }\n                        </div>\n\n                        {   // TODO: Add link to account opening page for upgrade or multi account page for new account.\n                            // Update text below for handling types of account to create :- e.g - Investment\n                            !!(this.props.is_upgrade_enabled && this.props.upgrade_info.can_open_multi) &&\n                            <UpgradeButton text={localize('Add new account')} />\n                        }\n                    </div>\n                }\n                {\n                    !isEmptyObject(vrt_account) &&\n                    <div className='acc-switcher__list--virtual'>\n                        <span className='acc-switcher__list-title'>\n                            {localize('Virtual account')}\n                        </span>\n                        <div className='acc-switcher__accounts'>\n                            <div\n                                className={classNames('acc-switcher__account', {\n                                    'acc-switcher__account--selected': (this.props.virtual_loginid === this.props.account_loginid),\n                                })}\n                                onClick={this.doSwitch.bind(this, this.props.virtual_loginid)}\n                            >\n                                <span className={classNames('acc-switcher__id', 'acc-switcher__id--virtual')}>\n                                    {this.props.virtual_loginid}\n                                </span>\n                            </div>\n                        </div>\n                    </div>\n                }\n                { !!(this.props.is_upgrade_enabled && this.props.is_virtual) &&\n                    <UpgradeButton text={localize('Upgrade to Real Account')} />\n                }\n                <div className='acc-switcher__logout' onClick={this.handleLogout}>\n                    <span className='acc-switcher__logout-text'>{localize('Log out')}</span>\n                    <Icon icon='IconLogout' className='acc-switcher__logout-icon drawer__icon' />\n                </div>\n            </div>\n        );\n    }\n}\n\nAccountSwitcher.propTypes = {\n    account_list          : PropTypes.array,\n    account_loginid       : PropTypes.string,\n    cleanUp               : PropTypes.func,\n    clearContract         : PropTypes.func,\n    clearError            : PropTypes.func,\n    has_error             : PropTypes.bool,\n    is_logged_in          : PropTypes.bool,\n    is_positions_drawer_on: PropTypes.bool,\n    is_upgrade_enabled    : PropTypes.bool,\n    is_virtual            : PropTypes.bool,\n    is_visible            : PropTypes.bool,\n    onClickUpgrade        : PropTypes.func,\n    toggle                : PropTypes.func,\n    togglePositionsDrawer : PropTypes.func,\n    upgrade_info          : PropTypes.object,\n    virtual_loginid       : PropTypes.string,\n};\n\nconst account_switcher = connect(\n    ({ client, ui, modules }) => ({\n        account_list          : client.account_list,\n        account_loginid       : client.loginid,\n        is_logged_in          : client.is_logged_in,\n        is_virtual            : client.is_virtual,\n        switchAccount         : client.switchAccount,\n        upgrade_info          : client.upgrade_info,\n        cleanUp               : client.cleanUp,\n        virtual_loginid       : client.virtual_account_loginid,\n        clearContract         : modules.trade.clearContract,\n        clearError            : modules.contract_trade.clearError,\n        has_error             : modules.contract_trade.has_error,\n        is_positions_drawer_on: ui.is_positions_drawer_on,\n        togglePositionsDrawer : ui.togglePositionsDrawer,\n\n    }),\n)(AccountSwitcher);\n\nexport { account_switcher as AccountSwitcher };\n","import classNames          from 'classnames';\nimport PropTypes           from 'prop-types';\nimport React               from 'react';\nimport { CSSTransition }   from 'react-transition-group';\nimport { AccountSwitcher } from 'App/Containers/AccountSwitcher';\nimport Icon                from 'Assets/icon.jsx';\n\n// todo fix absolute path\n\nconst AccountInfo = ({\n    balance,\n    currency,\n    loginid,\n    is_dialog_on,\n    is_upgrade_enabled,\n    is_virtual,\n    onClickUpgrade,\n    toggleDialog,\n}) => (\n    <div className='acc-info__wrapper'>\n        <div\n            className={classNames('acc-info', {\n                'acc-info--show'      : is_dialog_on,\n                'acc-info--is-virtual': is_virtual,\n            })}\n            onClick={toggleDialog}\n        >\n            <p\n                className='acc-info__id'\n                title={loginid}\n            >\n                {loginid}&nbsp;\n            </p>\n            {\n                typeof balance !== 'undefined' &&\n                <p className='acc-info__balance'>\n                    <span\n                        className={classNames('symbols', { [`symbols--${(currency || '').toLowerCase()}`]: currency })}\n                    />\n                    {balance}\n                </p>\n            }\n            <Icon icon='IconArrowBold' className='acc-info__select-arrow' />\n        </div>\n        <CSSTransition\n            in={is_dialog_on}\n            timeout={200}\n            classNames={{\n                enter    : 'acc-switcher__wrapper--enter',\n                enterDone: 'acc-switcher__wrapper--enter-done',\n                exit     : 'acc-switcher__wrapper--exit',\n            }}\n            unmountOnExit\n        >\n            <div className='acc-switcher__wrapper'>\n                <AccountSwitcher\n                    is_visible={is_dialog_on}\n                    toggle={toggleDialog}\n                    is_upgrade_enabled={is_upgrade_enabled}\n                    onClickUpgrade={onClickUpgrade}\n                />\n            </div>\n        </CSSTransition>\n    </div>\n);\n\nAccountInfo.propTypes = {\n    account_type      : PropTypes.string,\n    balance           : PropTypes.string,\n    currency          : PropTypes.string,\n    is_dialog_on      : PropTypes.bool,\n    is_upgrade_enabled: PropTypes.bool,\n    is_virtual        : PropTypes.bool,\n    loginid           : PropTypes.string,\n    onClickUpgrade    : PropTypes.func,\n    toggleDialog      : PropTypes.func,\n};\n\nexport default AccountInfo;\n"],"sourceRoot":""}